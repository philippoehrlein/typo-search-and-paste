(function(){"use strict";const e=window.Vue;function _(){return window.panel}e.computed,e.customRef,e.defineAsyncComponent,e.defineComponent,e.effectScope,e.getCurrentInstance,e.getCurrentScope,e.h,e.inject,e.isProxy,e.isReactive,e.isReadonly,e.isRef,e.isShallow,e.markRaw;const C=e.nextTick;e.onActivated,e.onBeforeMount,e.onBeforeUnmount,e.onBeforeUpdate,e.onDeactivated,e.onErrorCaptured;const y=e.onMounted;e.onRenderTracked,e.onRenderTriggered,e.onScopeDispose,e.onServerPrefetch;const m=e.onUnmounted;e.onUpdated,e.provide,e.proxyRefs,e.reactive,e.readonly;const p=e.ref;e.shallowReactive,e.shallowReadonly,e.shallowRef,e.toRaw,e.toRef,e.toRefs,e.triggerRef,e.unref,e.useAttrs,e.useCssModule,e.useCssVars,e.useListeners,e.useSlots;const g=e.watch;e.watchEffect,e.watchPostEffect,e.watchSyncEffect;function h(i,t,n,s,r,o,l,f){var u=typeof i=="function"?i.options:i;return t&&(u.render=t,u.staticRenderFns=n,u._compiled=!0),o&&(u._scopeId="data-v-"+o),{exports:i,options:u}}const R={__name:"TSPButton",setup(i){const t=_();function n(){window.panel.dialog.open({component:"k-typo-search-and-paste-dialog"})}return{__sfc:!0,panel:t,openTSPPanel:n}}};var w=function(){var t=this,n=t._self._c,s=t._self._setupProxy;return n("div",[n("k-button",{attrs:{dropdown:!1,title:s.panel.t("philippoehrlein.typo-search-and-paste.buttonTitle"),variant:"filled",size:"sm",icon:"typo-search-and-paste"},on:{click:s.openTSPPanel}})],1)},S=[],T=h(R,w,S,!1,null,null);const P=T.exports,$={__name:"TSPResults",props:{results:{type:Array,required:!0},queryLength:{type:Number,required:!0}},emits:["close","focusinput"],setup(i,{expose:t,emit:n}){const s=i,r=_(),o=p(-1),l=p([]),f=(a,c)=>{a&&(l.value[c]=a)};g(()=>s.results,()=>{o.value=-1});const u=a=>{C(()=>{var c;l.value[a]&&((c=l.value[a].$el)==null||c.focus())})},v=a=>{const{key:c}=a;c==="ArrowDown"?(a.preventDefault(),o.value<s.results.length-1&&(o.value++,u(o.value))):c==="ArrowUp"?(a.preventDefault(),o.value>0?(o.value--,u(o.value)):n("focusinput")):c==="Escape"&&(a.preventDefault(),n("close"))};t({focusFirst:()=>{s.results.length>0&&(o.value=0,u(0))},focusLast:()=>{s.results.length>0&&(o.value=s.results.length-1,u(s.results.length-1))}});function d(a){navigator.clipboard.writeText(a),n("close"),r.notification.info({message:r.t("philippoehrlein.typo-search-and-paste.copiedMessage",{character:a}),icon:void 0})}return{__sfc:!0,props:s,emit:n,panel:r,activeIndex:o,buttonRefs:l,setButtonRef:f,focusButton:u,handleKeydown:v,copyToClipboard:d}}};var k=function(){var t=this,n=t._self._c,s=t._self._setupProxy;return t.queryLength>2?n("div",{staticClass:"tsp-results-container"},[t.results.length>0?n("div",{staticClass:"tsp-results"},t._l(t.results,function(r,o){return n("k-button",{key:r.value,ref:l=>s.setButtonRef(l,o),refInFor:!0,staticClass:"tsp-results__result",class:{"tsp-results__result--active":s.activeIndex===o},attrs:{tabindex:"0",role:"menuitem",title:r.name},on:{click:function(l){return s.copyToClipboard(r.value)}},nativeOn:{keydown:function(l){return s.handleKeydown.apply(null,arguments)}}},[n("span",{staticClass:"tsp-results__result-value"},[t._v(t._s(r.value))]),n("span",{staticClass:"tsp-results__result-name"},[t._v(t._s(r.name))])])}),1):n("div",{staticClass:"tsp-results__no-results"},[n("p",[t._v(t._s(s.panel.t("philippoehrlein.typo-search-and-paste.noResults")))])])]):t._e()},b=[],L=h($,k,b,!1,null,"cd3041f3");const F=L.exports,I={__name:"TSPSearch",emits:["result","length","close","focusresults"],setup(i,{expose:t,emit:n}){const s=_(),r=p(""),o=p([]),l=p(null);let f=null;const u=async a=>{if(a.length<3){o.value=[];return}const c=a.trim().replace(/\s+/g," AND "),j=encodeURIComponent(c),N=await window.panel.api.get(`tsp-search/${j}`);try{o.value=N.results,n("result",o.value),n("length",a.length)}catch(V){console.error(V)}},v=a=>{if(r.value=a,a.length<3){o.value=[],n("length",a.length),n("result",o.value);return}f&&clearTimeout(f),f=setTimeout(()=>{u(a)},300)},d=a=>{const{key:c}=a;c==="ArrowDown"&&o.value.length>0?(a.preventDefault(),n("focusresults")):c==="Escape"&&(a.preventDefault(),n("close"))};return y(()=>{l.value&&l.value.$el&&(l.value.$el.addEventListener("keydown",d),console.log("Event listener added to input element"))}),m(()=>{l.value&&l.value.$el&&l.value.$el.removeEventListener("keydown",d)}),t({focus:()=>{l.value&&l.value.focus()}}),{__sfc:!0,emit:n,panel:s,value:r,results:o,searchInput:l,searchTimeout:f,search:u,onInput:v,handleKeydown:d}}};var x=function(){var t=this,n=t._self._c,s=t._self._setupProxy;return n("div",{staticClass:"tsp-search"},[n("k-search-input",{ref:"searchInput",attrs:{placeholder:s.panel.t("philippoehrlein.typo-search-and-paste.searchPlaceholder","Search for special characters"),value:s.value,autofocus:""},on:{input:s.onInput}}),n("k-button",{staticClass:"k-search-bar-close",attrs:{icon:t.isLoading?"loader":"cancel",title:t.$t("close")},on:{click:function(r){return t.$emit("close")}}})],1)},D=[],B=h(I,x,D,!1,null,null);const A=B.exports,M={__name:"TSPPanel",emits:["close"],setup(i,{emit:t}){const n=_(),s=p([]),r=p(0),o=p(null),l=p(null);return{__sfc:!0,emit:t,panel:n,results:s,queryLength:r,searchComponent:o,resultsComponent:l,handleResults:c=>{s.value=c},handleLength:c=>{r.value=c},handleClose:()=>{t("close")},handleFocusResults:()=>{console.log("handleFocusResults"),l.value&&l.value.focusFirst()},handleFocusInput:()=>{o.value&&o.value.focus()},TSPResults:F,TSPSearch:A}}};var U=function(){var t=this,n=t._self._c,s=t._self._setupProxy;return n("k-dialog",{staticClass:"k-typo-search-and-paste-dialog",attrs:{"cancel-button":!1,"submit-button":!1,visible:!0,size:"medium",role:"dialog","aria-labelledby":"typo-search-and-paste-dialog-title"},on:{cancel:function(r){return s.emit("cancel")}}},[n("h2",{staticClass:"sr-only",attrs:{id:"typo-search-and-paste-dialog-title"}},[t._v(" "+t._s(s.panel.t("philippoehrlein.typo-search-and-paste.buttonTitle","Search Special Characters"))+" ")]),n(s.TSPSearch,{ref:"searchComponent",on:{result:s.handleResults,length:s.handleLength,close:s.handleClose,focusresults:s.handleFocusResults}}),n(s.TSPResults,{ref:"resultsComponent",attrs:{results:s.results,"query-length":s.queryLength},on:{close:s.handleClose,focusinput:s.handleFocusInput}})],1)},q=[],E=h(M,U,q,!1,null,null);const z=E.exports,K={"typo-search-and-paste":'<path d="M11.9424 2.74805C13.8302 2.74809 15.4545 3.06805 16.8145 3.70801C18.1743 4.34801 19.2221 5.30057 19.958 6.56445C20.6778 7.81231 21.038 9.37994 21.0381 11.2676C21.0381 13.1395 20.6779 14.7077 19.958 15.9717C19.2221 17.2356 18.1743 18.1881 16.8145 18.8281C15.4545 19.4681 13.8302 19.788 11.9424 19.7881C11.7184 19.7881 11.4935 19.7797 11.2695 19.7637C11.0298 19.7477 10.798 19.7318 10.5742 19.7158L7.50195 22.6201H4.50098L7.85156 19.4443L8.10156 19.2119L8.09863 19.2109L9.77539 17.6221C10.4438 17.769 11.1662 17.8438 11.9424 17.8438C12.9501 17.8437 13.8619 17.7243 14.6777 17.4844C15.4937 17.2284 16.2065 16.844 16.8145 16.332C17.4063 15.8201 17.8617 15.1716 18.1816 14.3877C18.5016 13.5878 18.6621 12.6361 18.6621 11.5322V11.0039C18.6621 9.89994 18.5016 8.95586 18.1816 8.17188C17.8617 7.37212 17.4062 6.71602 16.8145 6.2041C16.2065 5.6921 15.4937 5.31617 14.6777 5.07617C13.8619 4.82024 12.9502 4.69242 11.9424 4.69238C10.9505 4.69238 10.0464 4.82025 9.23047 5.07617C8.39847 5.31617 7.68575 5.6921 7.09375 6.2041C6.50185 6.71608 6.04555 7.37196 5.72559 8.17188C5.38961 8.95585 5.22169 9.89997 5.22168 11.0039V11.5322C5.2217 12.6359 5.38972 13.5878 5.72559 14.3877C6.04556 15.1716 6.50181 15.82 7.09375 16.332C7.2996 16.5101 7.521 16.6713 7.75586 16.8184L6.19531 18.3115C5.41782 17.8061 4.76499 17.1712 4.23828 16.4043C3.32628 15.0763 2.87012 13.3636 2.87012 11.2676C2.87017 9.38002 3.23788 7.81228 3.97363 6.56445C4.6936 5.30052 5.73385 4.34801 7.09375 3.70801C8.43775 3.06801 10.0544 2.74805 11.9424 2.74805Z"/>'};window.panel.plugin("philippoehrlein/typo-search-and-paste",{icons:K,components:{"k-typo-search-and-paste-dialog":z},viewButtons:{"typo-search-and-paste":P}})})();
